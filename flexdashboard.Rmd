---
title: "Instacart Visualization"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---
  
```{r setup, include=FALSE}

library(flexdashboard)
library(tidyverse)
library(janitor)
library(stringr)
library(forcats)
library(viridis)
library(plotly)
library(magrittr)
library(readr)
library(scales)

```


```{r data_tidy}

instacart = read_csv("./data/instacart_train_data.csv.zip") %>%
  clean_names() %>%
  distinct()


```


Column {data-width=650}
-----------------------------------------------------------------------

### Department Frequency

```{r department_frequency}

barplot_department_ggplot = instacart %>% 
  count(department) %>% 
  mutate(department = fct_reorder(department, n)) %>% 
  ggplot(aes(x = department, y = n, fill = department)) +
    geom_bar(stat = "identity") + 
    theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
    scale_y_continuous(name = "N", labels = scales::unit_format("k", 1e-3)) 

ggplotly(barplot_department_ggplot)

```

Column {data-width=350}
-----------------------------------------------------------------------

### Most Popular Products by Aisle in the Produce Department

```{r popular products}

barplot_popular_produce = instacart %>% 
  filter(department == "produce") %>% 
  group_by(aisle) %>% 
  count(product_name) %>% 
  top_n(2) %>% 
  ggplot(aes(x = aisle, y = n, fill = product_name)) +
        geom_bar(stat="identity", position="dodge") +
        theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
        labs(title = "Most Popular Products by Aisle in Produce Department")

ggplotly(barplot_popular_produce)

```

### Distribution of Order Hour of Day by Department

```{r boxplot order hour}

boxplot_order_hour = instacart %>% 
  ggplot(aes(x = department, y = order_hour_of_day, fill = department)) + geom_boxplot()

ggplotly(boxplot_order_hour)

```

